CREATE DATABASE EMPLOYEE_ATTRITION_DATA;

USE EMPLOYEE_ATTRITION_DATA;

SELECT * FROM [EMPLOYEE DATA];

SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'EMPLOYEE DATA';

--COUNT TOTAL EMPLOYEES :

SELECT
     COUNT(EMPLOYEENUMBER)AS TOTAL_EMPLOYEE
FROM
    [EMPLOYEE DATA];

--LIST EMPLOYEE WHO ARE OLDER THAN 40

SELECT *
FROM [EMPLOYEE DATA]
WHERE AGE > 40;

--TOTAL ATTRITION COUNT

SELECT
     COUNT(ATTRITION)AS TOTAL_ATTRITION
FROM
    [EMPLOYEE DATA]
WHERE 
    Attrition = 1;

--AVERAGE MONTHLY INCOME BY DEPARTMENT

SELECT 
     DEPARTMENT,
     AVG(MONTHLYINCOME)AS AVG_MONTHLY_INCOME
FROM
    [EMPLOYEE DATA]
GROUP BY
     Department;


--GENDER DISTRIBUTION IN THE COMPANY :

SELECT 
     GENDER,
	 COUNT(GENDER)AS NUMBER
FROM
    [EMPLOYEE DATA]
GROUP BY
     GENDER;


--EMPLOYEE WITH THE HIGH JOB SATISFACTION

SELECT *
FROM
    [EMPLOYEE DATA]
WHERE
    JobSatisfaction = 4;


--TOP 5 EMPLOYEE WITH THE HIGHEST MONTHLY RATE :

SELECT
     TOP 5 *
FROM
     [EMPLOYEE DATA]
ORDER BY
    MonthlyRate DESC;


--AVERAGE NUMBER OF YEARS WITH CURRENT MANAGER BY JOB ROLE :

SELECT 
    JOBROLE,
    AVG(YEARSWITHCURRMANAGER)AS AVG_YEAR_CURR_MNGR
FROM
    [EMPLOYEE DATA]
GROUP BY
    JOBROLE;


--NUMBER OF EMPLOYEE BY EDUCATION FIELD

SELECT 
     EducationField,
	 COUNT(*) 'AS NUMBER OF EMP'
FROM
     [EMPLOYEE DATA]
GROUP BY
     EducationField;


--DEPARTMENT WITH THE HIGHEST AVERAGE PERFORMNACE RATING :

SELECT 
     DEPARTMENT,
	 AVG(PERFORMANCERATING)AS AVG_RATING
FROM
    [EMPLOYEE DATA]
GROUP BY
     DEPARTMENT
ORDER BY
     AVG_RATING DESC;


--ATTRITION RATE BY DEPARTMENT



--AVERAGE SALARY HIKE BASED ON JOB INVOLVEMENT

SELECT 
     JobInvolvement,
	 AVG(PERCENTSALARYHIKE) AS AVG_HIKE
FROM
     [EMPLOYEE DATA]
GROUP BY
     JobInvolvement;


--CORRELATION BETWEEN TOTAL WORKING YEARS AND ATTRITION

SELECT
     TOTALWORKINGYEARS,
	 COUNT(*) AS NUMBER
FROM
     [EMPLOYEE DATA]
WHERE
    Attrition = 1
GROUP BY
     TotalWorkingYears;


--EMPLOYEES WORKING OVERTIME WITH HIGH JOB SATISFACTION

SELECT *
FROM 
    [EMPLOYEE DATA]
WHERE
   OverTime = 1
   AND JobSatisfaction >= 3;


--FIND OUT THE EMPLOYEE WITH OVER 10 YEARS AT THE COMPANY BUT WITH NO PROMOTIONS:

SELECT *
FROM
   [EMPLOYEE DATA]
WHERE
    YearsAtCompany > 10
	AND YearsSinceLastPromotion = 0;


--CORRELATION BETWEEN DISTANCE FROM HOME AND ATTRITION

SELECT
     DISTANCEFROMHOME,
	 COUNT(*)AS NUMBER
FROM
     [EMPLOYEE DATA]
WHERE
     Attrition = 1
GROUP BY
     DistanceFromHome;


--AVERAGE INCOME COMPARISON BETWEEN EMPLOYEES WORKING OVERTIME VS NOT :

SELECT 
     OverTime,
	 AVG(MONTHLYINCOME)AS AVG_INCOME
FROM
     [EMPLOYEE DATA]
GROUP BY
     OVERTIME;


--TOP FACTORS CONTRIBUTING TO EMP ATT(JOB SATISFACTION,ENVIRONMENT SATISFACTION)

SELECT
     JOBSATISFACTION,
	 ENVIRONMENTSATISFACTION,
	 COUNT(*) AS NUMBER
FROM
    [EMPLOYEE DATA]
WHERE
    Attrition = 1
GROUP BY
    JOBSATISFACTION,
	ENVIRONMENTSATISFACTION;


--ATTRITION RATE BASED ON YEARS AT THE COMPANY

SELECT 
     YearsAtCompany,
	 (COUNT(CASE WHEN ATTRITION = 1 THEN 1 END) 
	 * 100.0 / COUNT(*)) AS ATTRITION_RATE
FROM
    [EMPLOYEE DATA]
GROUP BY
    YearsAtCompany;


--TOP 3 DEPARTMENTS WITH THE HIGHEST ATTRITION RATE :

SELECT
     TOP 3 DEPARTMENT,
	 (COUNT(CASE WHEN ATTRITION = 1 THEN 1 END) * 100.0 /
	 COUNT(*)) AS ATTRITION_RATE
FROM
     [EMPLOYEE DATA]
GROUP BY
      DEPARTMENT
ORDER BY
      ATTRITION_RATE DESC;


-- ATTRITION RATE BY DEPARTMENT

SELECT
     DEPARTMENT,
	 (COUNT(CASE WHEN ATTRITION = 1 THEN 1 END) *
	 100.0 / COUNT(*)) AS ATTRITION_RATE
FROM
    [EMPLOYEE DATA]
GROUP BY
     Department;